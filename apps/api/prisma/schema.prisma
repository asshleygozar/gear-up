generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model accounts {
  account_id                                              Int            @id @default(autoincrement())
  account_name                                            String         @db.VarChar(255)
  account_type                                            String         @db.VarChar(255)
  total_balance                                           Decimal        @db.Decimal(10, 2)
  total_income                                            Decimal        @db.Decimal(10, 2)
  total_expense                                           Decimal        @db.Decimal(10, 2)
  user_id                                                 Int
  users                                                   users          @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction)
  transactions_transactions_account_id_receiverToaccounts transactions[] @relation("transactions_account_id_receiverToaccounts")
  transactions                                            transactions[]
}

model transactions {
  transaction_id                                      Int           @id @default(autoincrement())
  transaction_category                                String        @db.VarChar(255)
  transaction_amount                                  Decimal       @db.Decimal(10, 2)
  transaction_date                                    DateTime      @default(now()) @db.Timestamp(6)
  transaction_description                             String?       @db.VarChar(255)
  account_id                                          Int
  user_id                                             Int
  account_id_receiver                                 Int?
  transaction_type                                    transac_type?
  accounts_transactions_account_id_receiverToaccounts accounts?     @relation("transactions_account_id_receiverToaccounts", fields: [account_id_receiver], references: [account_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_account_receiver")
  accounts                                            accounts      @relation(fields: [account_id], references: [account_id], onDelete: Cascade, onUpdate: NoAction)
  users                                               users         @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction)
}

model users {
  email        String         @unique @db.VarChar(255)
  password     String         @db.VarChar(255)
  first_name   String?        @db.VarChar(255)
  last_name    String?        @db.VarChar(255)
  username     String         @unique @db.VarChar(255)
  user_id      Int            @id @default(autoincrement())
  created_at   DateTime       @default(now()) @db.Timestamp(6)
  updated_at   DateTime       @default(now()) @db.Timestamp(6)
  accounts     accounts[]
  budgets      budgets[]
  transactions transactions[]
}

model budgets {
  budget_id             Int                @id @default(autoincrement())
  budget_current_amount Decimal?           @db.Decimal(10, 2)
  budget_start          DateTime           @db.Timestamp(6)
  budget_end            DateTime           @db.Timestamp(6)
  budget_period         budget_period_type
  budget_category       String             @db.VarChar(255)
  budget_description    String?            @db.VarChar(255)
  user_id               Int
  budget_max_amount     Decimal            @db.Decimal(10, 2)
  users                 users              @relation(fields: [user_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
}

enum transac_type {
  income
  expense
  transfer
}

enum budget_period_type {
  weekly
  monthly
  one_time @map("one-time")
  daily
}
